@* ***** BEGIN LICENSE BLOCK *****
* Version: MPL 2.0/GPL 2.0/LGPL 2.1
*
* The contents of this file are subject to the Mozilla Public License
* Version 2.0 (the "License"); you may not use this file except in
* compliance with the License. You may obtain a copy of the License at
* http://www.mozilla.org/MPL/
*
* Software distributed under the License is distributed on an "AS IS"basis,
* WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
* for the specific language governing rights and limitations under the
* License.
*
* Contributor(s):
* Beemen Beshara
* Søren Kirkegård
*
* The code is currently governed by OS2 - Offentligt digitaliserings-
* fællesskab / http://www.os2web.dk .
*
* Alternatively, the contents of this file may be used under the terms of
* either the GNU General Public License Version 2 or later (the "GPL"), or
* the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
* in which case the provisions of the GPL or the LGPL are applicable instead
* of those above. If you wish to allow use of your version of this file only
* under the terms of either the GPL or the LGPL, and not to allow others to
* use your version of this file under the terms of the MPL, indicate your
* decision by deleting the provisions above and replace them with the notice
* and other provisions required by the GPL or the LGPL. If you do not delete
* the provisions above, a recipient may use your version of this file under
* the terms of any one of the MPL, the GPL or the LGPL.
*
* ***** END LICENSE BLOCK ***** *@
@(persons: java.util.List[util.cprbroker.IPerson], results: Int, currentpage: Int, location: String, searchInput: Search.SearchInput, accesslevel: Integer)

    @main("CPReader", searchInput) {

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                @if(persons != null) {
                    @Messages("results.list.amountOfResults", results) <strong>@searchInput.getQuery()</strong>
                    @if(searchInput.getAddressQuery() != null && searchInput.getAddressQuery().length > 0) {
                            &nbsp;@searchInput.getAddressQuery();
                    }
                } else {
                    @Messages("results.list.searchFailed", results)
                }
                </h3>
            </div>
        </div>
       
        

        <div class="list-group">
        @if(persons != null) {
            <div class="panel panel-default">
                <div class="panel-heading">
                @if(searchInput.online) {
                    <h4>@Messages("results.list.online_desc_1")</h4>
                    @Messages("results.list.online_desc_2")<br/>
                    @Messages("results.list.online_desc_3")
                } else {
                    <h4>@Messages("results.list.local_desc_1")</h4>
                    @Messages("results.list.local_desc_2")<br/>
                    @Messages("results.list.local_desc_3")
                }
                </div>
            </div>

            @for(person <- persons) {
                <div class="row">
                    <div class="col-md-9">
                        @if(accesslevel == 2) {
                        <a href="/showfull/uuid/@person.uuid/" class="list-group-item">
                        } else {
                        <div class="panel panel-default">
                        <div class="panel-heading">
                        }
                        @person.registerInformation.cprCitizen.socialSecurityNumber
                        @if(person.firstname) {
                            @person.firstname
                        }
                        @if(person.middelname) {
                            @person.middelname
                        }
                        @if(person.lastname) {
                            @person.lastname
                        }
                        @if(person.address != null && person.address.addressType == util.cprbroker.EAddressType.Danish) {
                            <span class="text-muted">
                                @if(person.address.danishAddress.streetName) {
                                    @person.address.danishAddress.streetName
                                }
                                @if(person.address.danishAddress.streetBuilding) {
                                    @person.address.danishAddress.streetBuilding
                                }
                                @if(person.address.danishAddress.floor) {
                                    @person.address.danishAddress.floor
                                }
                                @if(person.address.danishAddress.suite) {
                                    @person.address.danishAddress.suite
                                }
                                @if(person.address.danishAddress.postCode) {
                                    @person.address.danishAddress.postCode
                                }
                                @if(person.address.danishAddress.districtName) {
                                    @person.address.danishAddress.districtName
                                }
                            </span>
                            @if(person.tilstand.livStatusKode != null) {    
                                ( @person.tilstand.livStatusKode
                                @if(person.tilstand.livTilstandsVirkning.fraTidspunkt != null) {
                                    @virkning(person.tilstand.livTilstandsVirkning, false)
                                })
                            }
                        }
                    @if(accesslevel == 2) {
                    </a>
                    } else {
                    </div>   
                    </div>
                    }
                    </div>
                    <div class="col-md-3">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                            <div id="session" style="display: none;">
                            @session.put(person.firstname+person.lastname, person.registerInformation.cprCitizen.socialSecurityNumber)
                            </div>
                            @cart(person)
                            </div>
                        </div>
                    </div>
                </div>
                @if(accesslevel == 1) {
                    <div class="row">
                        <div class="col-md-12">
                        @if(person.relationsWithPerson != null) {
   
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Relationer</h3>
                                </div>
                            </div>

                            @for(r <- person.relationsWithPerson.allRelations) {
                                @relation(r) 
                            }
                        }
                        </div>
                    </div>
                }
            }
        }
        </div>
    }